"use strict";class t{constructor(t){const{el:e,attr:n,lineWidth:o}=t;if(this.options=t,!(e&&e instanceof HTMLElement))throw new Error("el 未传入”HTMLElement“类型元素");this.el=e,this.attr=n,this.lineWidth=o||10,this.lastLocation={x:0,y:0},this.isMouseDown=!1;const i=this.createEle();if(!i)throw new Error("创建canvas元素失败");this.canvas=i,this.ctx=i.getContext("2d"),this.initEvent()}createEle(){const{el:t,attr:e}=this,{clientWidth:n,clientHeight:o}=t,i=document.createElement("canvas");i.width=n,i.height=o;for(const t of Object.keys(e))i.setAttribute(t,`${e[t]}`);return t.appendChild(i),i}initEvent(){const{canvas:t}=this,e=this;t.onmousedown=function(n){n.preventDefault(),e.isMouseDown=!0;const{x:o,y:i}=e.location(n);Object.assign(e.lastLocation,{x:o,y:i}),t.onmousemove=function(t){t.preventDefault(),e.draw(t)}},t.onmouseup=function(n){n.preventDefault(),e.isMouseDown=!1,t.onmousemove=null},t.onmouseenter=function(t){const{x:n,y:o}=e.location(t);Object.assign(e.lastLocation,{x:n,y:o})},t.onmouseleave=function(t){},document.onmouseup=function(n){e.isMouseDown&&(e.isMouseDown=!1,t.onmousemove=null)}}draw(t){const{ctx:e,lineWidth:n,lastLocation:o}=this,{x:i,y:s}=this.location(t);e&&(e.lineWidth=n,e.beginPath(),e.moveTo(o.x,o.y),e.lineTo(i,s),e.strokeStyle="red",e.lineCap="round",e.lineJoin="round",e.stroke(),Object.assign(o,{x:i,y:s}))}location(t){const{left:e,top:n}=this.canvas.getBoundingClientRect();if(!t)return{x:e,y:n};const{clientX:o,clientY:i}=t;return{x:o-e,y:i-n}}clearRectAction(){var t;let{width:e,height:n}=this.options.attr||{};if(!e||!n){const t=this.canvas.getBoundingClientRect();e=t.width,n=t.height}null===(t=this.ctx)||void 0===t||t.clearRect(0,0,e,n)}}Object.assign(window,{CWrite:class extends t{constructor(t){super(t)}clearRect(){this.clearRectAction()}}});
